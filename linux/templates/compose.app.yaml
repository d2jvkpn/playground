networks:
  net:
    name: app
    driver: bridge
    external: false
    #ipam:
    #  config:
    #  - { subnet: 172.24.0.0/24, gateway: 172.24.0.1, ip_range: 172.24.0.128/25 }

volumes:
  logs: { driver: local }

x-env: &x-env
  key1: value1

services:
  app:
    image: alpine:3
    restart: always
    container_name: app
    init: true
    hostname: app
    #depends_on: ["db"]
    #labels: { k1: v1 }
    expose: ["5000"]
    #network_mode: bridge
    networks: ["net"]
    ports: [127.0.0.1:5000:5000/tcp]
    #healthcheck:
    #  test: ["CMD", "curl", "-f", "http://localhost:5000"]
    #  start_period: 5s
    #  interval: 30s
    #  timeout: 10s
    #  retries: 3
    user: 1000:1000
    volumes:
    - ./configs:/opt/configs:ro
    - ./data:/opt/data
    - logs:/opt/logs
    environment:
      <<: *x-env
      APP: demo
    command:
    - sleep
    - infinity
